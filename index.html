<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link
      rel="stylesheet"
      href="https://unpkg.com/tdesign-react/dist/tdesign.min.css"
    />
    <style>
      * {
        margin: 0;
        box-sizing: border-box;
      }
      canvas {
        /* display: block; */
      }
    </style>
  </head>
  <body>
    <div id="app" class="w-screen h-screen flex"></div>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/tdesign-react/dist/tdesign.min.js"></script>
    <script src="https://unpkg.com/tdesign-icons-react@0.3.4/dist/index.min.js"></script>

    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="./dist/index.umd.js"></script>
    <script>
      console.log(window)
    </script>
    <script type="text/babel">
      function App() {
        const { useEffect, useRef, useState } = React
        const { NavigationArrowIcon, ArtboardIcon } = TDesignIconReact
        const Layout = TDesign.Layout
        const { Header, Content, Footer, Aside } = TDesign.Layout
        const { Row, Col } = TDesign
        const [design, setDesign] = useState(null)
        const [currentTool, setTool] = useState('select')
        const [rect, setRect] = useState(null)

        useEffect(() => {
          let designIns = new Design({
            target: '#design',
          })
          setDesign(designIns)
          designIns.sceneGraph.tool.on('onChange', setTool)
          designIns.sceneGraph.on('selectTemplate', setRect)
          designIns.sceneGraph.on('watchRect', setRect)

          return () => {
            setDesign(null)
          }
        }, [])

        function changeTool(tool) {
          design.activeTool(tool)
        }
        return (
          <>
            <Layout>
              <Header className="border-b-2 ">
                <div className="flex h-full items-center">
                  <div className="w-[100px] h-full"></div>
                  <TDesign.Space>
                    <TDesign.Tooltip
                      content="选择"
                      destroyOnClose
                      showArrow
                      theme="default"
                    >
                      <div
                        onClick={() => changeTool('select')}
                        className={`w-[40px] h-[40px]  rounded flex justify-center items-center ${
                          currentTool === 'select'
                            ? 'bg-[#38bdf8] text-white'
                            : ''
                        }`}
                      >
                        <NavigationArrowIcon className="rotate-[-45deg] w-[20px!important] h-[20px!important] " />
                      </div>
                    </TDesign.Tooltip>
                    <TDesign.Tooltip
                      content="模板"
                      destroyOnClose
                      showArrow
                      theme="default"
                    >
                      <div
                        onClick={() => changeTool('DRAWVIEW')}
                        className={`w-[40px] h-[40px]  rounded flex justify-center items-center ${
                          currentTool === 'DRAWVIEW'
                            ? 'bg-[#38bdf8] text-white'
                            : ''
                        }`}
                      >
                        <ArtboardIcon className=" w-[20px!important] h-[20px!important]" />
                      </div>
                    </TDesign.Tooltip>
                  </TDesign.Space>
                </div>
              </Header>
              <Layout>
                <Aside className="border-r-2"></Aside>
                <Layout>
                  <Content>
                    <div id="design" style={{ height: '100%' }}></div>
                  </Content>
                  <Aside width={'300px'}>
                    {rect ? (
                      <>
                        <Row gutter={0}>
                          <Col span={6}>x：{rect?.x}</Col>
                          <Col span={6}>y：{rect?.y}</Col>
                        </Row>
                        <Row>
                          <Col span={6}>width：{rect?.width}</Col>
                          <Col span={6}>height：{rect?.height}</Col>
                        </Row>
                      </>
                    ) : null}
                  </Aside>
                </Layout>
              </Layout>
            </Layout>
          </>
        )
      }

      const container = document.getElementById('app')
      const root = ReactDOM.createRoot(container)
      root.render(<App />)
    </script>
  </body>
</html>
